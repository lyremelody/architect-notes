# 「Availability」可用性

<strong><font color="red">最后修改于2022-04-26</font></strong>

概念就那么些，花点时间整理一下，不搞清楚，多少年还是搞不清楚。

最近需要处理一些系统稳定性问题，所以整理记录一下。

「Availability」，相关翻译「可用性」。要注意跟「Usability」的区别，这个也经常翻译成「可用性」，今天我们讨论的不是这个「Usability」。

直观地讲，「Availability」可用性就是系统能不能正常工作的一种属性。可用性跟 [容错性](./fault-tolerance.md) 有些区别。

下面分别整理了几个领域关于可用性的定义。实际上我们日常说的每个概念，都是自带上下文的，这是容易忽视的。

## **软件质量模型中的「Availability」**

在计算机软件领域，ISO/IEC 25010 中定义的产品质量模型中，定义了八个质量属性：功能适用性(Function Suitability)、性能效率(Performance Efficiency)、兼容性(Compatibility)、可用性(Usability，其实我感觉翻译成「易用性」更容易避免歧义)、可靠性(Reliability)、安全(Security)、可维护性(Maintainability)、可移植性(Portability)。

其中「Availability」可用性属于可靠性(Reliability)属性的一个子属性。定义为：系统、产品或组件在需要使用时，可操作和可访问的程度。经常听到的「高可用」就是「high availability」、「HA」。「high availability」高可用，指系统能够比正常时间更久地保持一定的运行水平。能够正常访问时间越久，可用性就越高。

## **信息安全里的「Availability」**

很久以前参加过一些信息安全的培训。

最开始了解到的，就是信息安全三要素CIA，即：

* 「Confidentiality」保密性：保障数据不被未授权的用户访问或泄露。
* 「Integrity」完整性：保障数据不被未授权地篡改。
* 「Availability」可用性：保障已授权用户合法访问数据的权利。

信息安全三要素 CIA 是安全系统的基本属性。

数据安全的可用性，举个例子，系统被DDos攻击了，导致系统卡顿不提供服务，这个DDos就是在破坏可用性。

## **CAP定理中的「Availability」**

「CAP」是「Consistency/Availability/Partition tolerance」的简称：

* 「Consistency」一致性(强一致性)：在分布式系统中的同一数据多副本场景下，对于数据的更新操作体现出的效果与只有单份数据是一样的。换句话说，就是在所有节点访问的都是最新的数据副本。
* 「Availability」可用性：客户端在任何时刻对大规模数据系统的读/写操作都应该保证在限定延时内完成。换句话说，就是每次请求都能及时获得正确的响应，但不保证获得的数据是最新数据。
* 「Partition tolerance」分区容忍性：在大规模分布式数据系统中，网络分区现象，即分区间的机器无法进行网络通信的情况是必然会发生的，所以系统应该能够在这种情况下仍然继续工作。

CAP 最初由 Eric Brewer 于1999年提出。他同时证明了对于一个大规模分布式数据系统来说，CAP三要素不可兼得，同一个系统最多只能实现其中两个，而必须放宽第三个要素来保证其他两个要素被满足。

枚举出来就是要么AP，要么CP、要么AC，但是不存在CAP。

当然，在 2012 年 Eric Brewer (还是他) 在发表的「Eric Brewer.CAP Twelve Years Later: How the “Rules” Have Change. IEEE Computer Society.2012」中指出：实践过程中应用 CAP 理论时，不得不在三要素中选择两个而牺牲另外一个的做法具有误导性。具体内容以后再分享。总之，就是能够把对整个系统的概念范围拆小来考虑，在没发生网络分区的场景下，保证AC，实现整个系统的CAP；在发生网络分区时，进行状态管理，在网络分区解决之后，恢复数据一致性，让系统最终进入CAP状态。

「一致性」又有了不同的概念细分，比如弱一致性、最终一致性、单调写一致性等等。今天主要是关注可用性，一致性以后再总结。

其实这里讲的是，分布式数据系统的可用性「Availability」，即每次请求都能及时获得正确的响应。

我们一般在做系统设计的时候讲的可用性，大致就是这一类。在定义质量目标的时候，说的是「软件质量模型」里面的。

## **AWS 定义的(云服务)「Availability」**

关于「Availability」可用性，AWS的定义是：工作负载可供使用的时间百分比。可供使用(Available for use)指的是在有需要时履行其约定的功能。

这是 AWS 定义它提供的服务能力。

AWS 还定义了一个计算公式用来衡量服务可用性。

![](./availability/640.png)

这个用一段时间内 (通常是一年) 正常运行时间的百分比来衡量可用性。

其中「Total Time」就是用来评估可用性的总的时间，「Available for Use Time」是这个评估范围内能够正常运行的时间。

AWS还特别提到，有些厂商选择把计划的维护停机时间排除在「Total Time」之外，AWS觉得这么算不合适，因为在计划维护的时间内，这些厂商的客户实际上也可能是需要使用这些服务的。

通过 AWS 的这个定义，可以得到一个可用性指标对应的不可用时间。同时它还给出了相关的可用性对应的应用程序类别：

| **可用性** | **最大不可用时间** | **应用程序类别**                 |
| ---------- | ------------------ | -------------------------------- |
| 99%        | 3天15小时          | 批处理、数据提取、传输和负载作业 |
| 99.9%      | 8小时45分钟        | 内部工具，如知识管理、项目跟踪   |
| 99.95%     | 4小时22分钟        | 网上商务、销售点                 |
| 99.99%     | 52分钟             | 视频传输、广播工作负载           |
| 99.999%    | 5分钟              | ATM交易、电信工作负载            |

各厂商的云服务，都会采用这种百分比来描述服务的可用性，比如AWS EC2的可用性是99.99%。这些云服务能做到这么高的可用性，不是一个单点系统的设计和研发所能达到的。它可能涉及基础架构、设计、研发、运维等各方面，以及时间的沉淀。

这样看来，如果我们说「设计了一个具有 99.99% 可用性的系统」，这种描述应该是不准确的。

上面整理了在软件质量模型、信息安全、分布式系统、云服务等关于「Availability」可用性的定义。

总的来说，**「Availability」可用性，在我看来，就是系统能正常使用的程度，即收到的请求能够正常响应的程度。只是在不同领域，有的通过时间来评估，有的通过结果来评估。**

## 参考
1. https://iso25000.com/index.php/en/iso-25000-standards/iso-25010
2. https://docs.aws.amazon.com/wellarchitected/latest/reliability-pillar/availability.html
3. 《大数据日知录-架构与算法》

